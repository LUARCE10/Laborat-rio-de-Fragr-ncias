<!DOCTYPE html>
<html lang="pt-BR" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Laborat√≥rio de Fragr√¢ncias LUARCE</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;700;800&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Calm Harmony -->
    <!-- Application Structure Plan: The application is structured as an interactive 'Fragrance Creation Lab' rather than a linear guide. It features three main sections: 1) An 'Essence Explorer' for filtering and learning about available scents. 2) A 'Fragrance Creator' tool that guides users from selecting a desired emotion to seeing suggested combinations and interactively building a scent pyramid (top, middle, base notes). 3) A 'Launch Guide' checklist for next steps. This task-oriented flow (Explore -> Create -> Plan) was chosen to make the content more engaging, practical, and to empower the user to actively apply the guide's concepts, which is more effective than passive reading for a creative task like fragrance design. -->
    <!-- Visualization & Content Choices: Content is organized into interactive components. The core data (essences, families, combinations) is presented in a filterable card grid (HTML/JS) for easy exploration. The abstract concept of a scent pyramid is turned into a tangible, interactive diagram (HTML/CSS/JS with drag-and-drop) to improve understanding and engagement. The guided creation process uses simple buttons and dynamically updated text blocks (JS) to present client briefing outcomes as actionable suggestions. The launch plan is an interactive checklist (HTML). No chart libraries were needed as the source is qualitative. This approach prioritizes hands-on learning and creation. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: #FDFBF8;
            color: #402E32;
        }
        h1, h2, h3 {
            font-family: 'Plus Jakarta Sans', sans-serif;
            font-weight: 700;
        }
        .nav-link {
            transition: color 0.3s ease;
        }
        .nav-link:hover {
            color: #C58940;
        }
        .filter-btn {
            transition: all 0.3s ease;
            border: 1px solid #E5D9B6;
        }
        .filter-btn.active {
            background-color: #A47E3B;
            color: #FDFBF8;
            border-color: #A47E3B;
        }
        .essence-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: grab;
        }
        .essence-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.05), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .pyramid-dropzone {
            transition: background-color 0.3s ease, border-color 0.3s ease;
            border: 2px dashed #E5D9B6;
        }
        .pyramid-dropzone.drag-over {
            background-color: #E5D9B6;
            border-color: #A47E3B;
        }
        .emotion-btn {
            transition: all 0.3s ease;
        }
        .emotion-btn:hover, .emotion-btn.active {
            background-color: #402E32;
            color: #FDFBF8;
            transform: translateY(-2px);
        }
        .checklist-item label {
            transition: color 0.3s ease;
        }
        .checklist-item input:checked + label {
            text-decoration: line-through;
            color: #A47E3B;
        }
        .gemini-btn {
            background-color: #A47E3B;
            color: #FDFBF8;
        }
        .gemini-btn:hover {
            background-color: #8b6a31;
        }
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #A47E3B;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="antialiased">

    <header class="bg-white/80 backdrop-blur-md sticky top-0 z-50 shadow-sm">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <a href="#" class="text-2xl font-bold text-[#402E32]" aria-label="P√°gina Inicial">
                LUARCE
            </a>
            <div class="hidden md:flex items-center space-x-8">
                <a href="#explorer" class="nav-link">Explorar Ess√™ncias</a>
                <a href="#creator" class="nav-link">Criador de Fragr√¢ncias</a>
                <a href="#launch-guide" class="nav-link">Guia de Lan√ßamento</a>
            </div>
        </nav>
    </header>

    <main class="container mx-auto px-6 py-12 md:py-20">

        <section class="text-center mb-20">
            <h1 class="text-4xl md:text-6xl font-bold mb-4">Laborat√≥rio de Fragr√¢ncias</h1>
            <p class="text-lg md:text-xl max-w-3xl mx-auto text-gray-600">Transforme a identidade da sua marca em uma assinatura olfativa memor√°vel. Explore, crie e planeje sua pr√≥xima fragr√¢ncia de sucesso.</p>
        </section>

        <section id="explorer" class="mb-20">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-4">Explore Nossas Ess√™ncias</h2>
            <p class="text-center max-w-2xl mx-auto text-gray-600 mb-10">Filtre por fam√≠lia olfativa para conhecer os blocos de constru√ß√£o do seu pr√≥ximo aroma. Arraste uma ess√™ncia para a pir√¢mide na se√ß√£o 'Criador' para come√ßar a montar sua fragr√¢ncia.</p>
            
            <div id="filters" class="flex flex-wrap justify-center gap-2 md:gap-4 mb-10"></div>
            
            <div id="essence-grid" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-6"></div>
        </section>

        <section id="creator" class="mb-20 bg-white p-6 md:p-10 rounded-2xl shadow-lg border border-gray-100">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-10">Criador de Fragr√¢ncias</h2>
            
            <div class="grid lg:grid-cols-2 gap-10 md:gap-16">
                
                <div>
                    <h3 class="text-2xl font-semibold mb-2">Passo 1: Defina a Emo√ß√£o</h3>
                    <p class="text-gray-600 mb-6">Qual sensa√ß√£o principal sua fragr√¢ncia deve transmitir? Sua escolha guiar√° nossas sugest√µes de combina√ß√µes harm√¥nicas.</p>
                    <div id="emotion-filters" class="grid grid-cols-2 gap-3 mb-8"></div>
                    
                    <div id="suggestion-box" class="bg-stone-50 p-6 rounded-lg min-h-[200px]">
                        <h4 class="text-xl font-semibold mb-2 text-[#402E32]">Nossas Sugest√µes</h4>
                        <p id="suggestion-text" class="text-gray-600">Selecione uma emo√ß√£o acima para ver combina√ß√µes recomendadas e a psicologia por tr√°s delas.</p>
                    </div>
                </div>

                <div>
                    <h3 class="text-2xl font-semibold mb-2">Passo 2: Construa sua Pir√¢mide</h3>
                    <p class="text-gray-600 mb-6">Arraste as ess√™ncias da se√ß√£o de explora√ß√£o e solte-as nas camadas correspondentes para montar a estrutura da sua fragr√¢ncia.</p>
                    <div class="space-y-4">
                        <div class="text-center">
                            <h4 class="font-semibold text-amber-600">Notas de Sa√≠da</h4>
                            <div id="dropzone-top" class="pyramid-dropzone h-20 rounded-t-lg p-2 flex items-center justify-center flex-wrap gap-2" data-note-type="top">
                                <span class="text-gray-400">Primeira Impress√£o</span>
                            </div>
                        </div>
                        <div class="text-center">
                            <h4 class="font-semibold text-teal-600">Notas de Corpo</h4>
                            <div id="dropzone-middle" class="pyramid-dropzone h-24 p-2 flex items-center justify-center flex-wrap gap-2" data-note-type="middle">
                                <span class="text-gray-400">O Cora√ß√£o</span>
                            </div>
                        </div>
                        <div class="text-center">
                            <h4 class="font-semibold text-stone-700">Notas de Fundo</h4>
                            <div id="dropzone-base" class="pyramid-dropzone h-28 rounded-b-lg p-2 flex items-center justify-center flex-wrap gap-2" data-note-type="base">
                                <span class="text-gray-400">A Mem√≥ria</span>
                            </div>
                        </div>
                    </div>
                     <button id="reset-pyramid" class="mt-4 w-full bg-gray-200 text-gray-700 py-2 rounded-lg hover:bg-gray-300 transition-colors">Limpar Pir√¢mide</button>
                     <button id="generate-story-btn" class="mt-2 w-full gemini-btn font-semibold py-2 rounded-lg transition-colors hidden">‚ú® Gerar Nome e Hist√≥ria</button>
                </div>
            </div>
            <div id="story-output" class="mt-10 max-w-3xl mx-auto hidden"></div>
            <div id="bottle-output" class="mt-10 max-w-3xl mx-auto hidden"></div>
        </section>

        <section id="launch-guide">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-4">Guia de Lan√ßamento</h2>
            <p class="text-center max-w-2xl mx-auto text-gray-600 mb-10">Com sua fragr√¢ncia criada, use este checklist para garantir que seu lan√ßamento seja um sucesso e que a hist√≥ria do seu aroma seja contada da melhor forma.</p>

            <div class="max-w-2xl mx-auto bg-white p-6 md:p-8 rounded-2xl shadow-lg border border-gray-100">
                <div class="space-y-4">
                    <div class="checklist-item flex items-start">
                        <input type="checkbox" id="check1" class="mt-1 mr-3 h-5 w-5 rounded border-gray-300 text-[#A47E3B] focus:ring-[#A47E3B]">
                        <label for="check1" class="flex flex-col">
                            <span class="font-medium">Testar o Prot√≥tipo</span>
                            <span class="text-sm text-gray-500">Crie amostras e teste em diferentes ambientes. Colete feedback do seu p√∫blico-alvo.</span>
                        </label>
                    </div>
                    <div class="checklist-item flex items-start">
                        <input type="checkbox" id="check2" class="mt-1 mr-3 h-5 w-5 rounded border-gray-300 text-[#A47E3B] focus:ring-[#A47E3B]">
                        <label for="check2" class="flex flex-col">
                            <span class="font-medium">Criar a Hist√≥ria (Storytelling)</span>
                            <span class="text-sm text-gray-500">Desenvolva uma narrativa envolvente. O que inspirou essa fragr√¢ncia? Qual mem√≥ria ela evoca?</span>
                        </label>
                    </div>
                    <div class="checklist-item flex items-start">
                        <input type="checkbox" id="check3" class="mt-1 mr-3 h-5 w-5 rounded border-gray-300 text-[#A47E3B] focus:ring-[#A47E3B]">
                        <label for="check3" class="flex flex-col">
                            <span class="font-medium">Promover com os Sentidos</span>
                            <span class="text-sm text-gray-500">Use a narrativa na sua comunica√ß√£o visual e textual. Descreva as notas e as sensa√ß√µes que o aroma provoca.</span>
                        </label>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <footer class="bg-white mt-20 border-t border-gray-100">
        <div class="container mx-auto px-6 py-8 text-center text-gray-500">
            <p>&copy; 2025 LUARCE. Criando experi√™ncias olfativas √∫nicas.</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const essences = [
                { name: 'Lim√£o Siciliano', family: 'C√≠tricas', note: 'top' },
                { name: 'Alecrim e Lim√£o Siciliano', family: 'C√≠tricas', note: 'top' },
                { name: 'Coconut Lemonade', family: 'C√≠tricas', note: 'top' },
                { name: 'Bamboo e Alecrim', family: 'Herbais / Verdes', note: 'middle' },
                { name: 'Cascas e Folhas', family: 'Herbais / Verdes', note: 'middle' },
                { name: 'Lavanda', family: 'Florais', note: 'middle' },
                { name: 'Jasmim e Rom√£', family: 'Florais', note: 'middle' },
                { name: 'Orqu√≠dea', family: 'Florais', note: 'middle' },
                { name: 'Ch√° Branco', family: 'Florais', note: 'middle' },
                { name: 'Ma√ß√£ com Canela', family: 'Frutadas', note: 'middle' },
                { name: 'P√™ssego e Champagne', family: 'Frutadas', note: 'top' },
                { name: 'Cereja e Avel√£', family: 'Frutadas', note: 'middle' },
                { name: 'Cassis e Hibisco', family: 'Frutadas', note: 'middle' },
                { name: '√Çmbar e Bergamota', family: 'Orientais / Amadeiradas', note: 'base' },
                { name: 'Vanilla New', family: 'Orientais / Amadeiradas', note: 'base' },
                { name: 'Caf√© Torrado', family: 'Orientais / Amadeiradas', note: 'base' },
                { name: 'Floresta Encantada', family: 'Orientais / Amadeiradas', note: 'base' },
                { name: 'Lim√£o e Verbena', family: 'Marinhas / Aqu√°ticas', note: 'top' },
                { name: 'Canela', family: 'Especiarias / Gourmand', note: 'middle' },
                { name: 'Alecrim', family: '√ìleos Essenciais', note: 'middle' },
                { name: 'S√¢ndalo', family: '√ìleos Essenciais', note: 'base' },
                { name: 'Tea Tree (Melaleuca)', family: '√ìleos Essenciais', note: 'middle' },
                { name: 'Menta Piperita', family: '√ìleos Essenciais', note: 'top' },
                { name: 'Laranja Doce', family: '√ìleos Essenciais', note: 'top' },
                { name: 'Ger√¢nio', family: '√ìleos Essenciais', note: 'middle' },
            ];

            const families = ['Todas', ...new Set(essences.map(e => e.family))];
            
            const suggestions = {
                tranquilidade: {
                    title: 'Combina√ß√µes para Tranquilidade',
                    text: 'Para um efeito calmante, combine notas florais e herbais com uma base amadeirada. Elas promovem relaxamento e bem-estar, ideal para spas, quartos e espa√ßos de medita√ß√£o.',
                    examples: ['`Lavanda` + `S√¢ndalo` (equil√≠brio)', '`Ch√° Branco` + `Bamboo` (leveza)']
                },
                energia: {
                    title: 'Combina√ß√µes para Energia',
                    text: 'Para um impulso de vitalidade, misture notas c√≠tricas vibrantes com herbais estimulantes. Perfeito para escrit√≥rios, academias e para come√ßar o dia com foco.',
                    examples: ['`Lim√£o Siciliano` + `Alecrim` (foco)', '`Laranja Doce` + `Menta Piperita` (alegria)']
                },
                aconchego: {
                    title: 'Combina√ß√µes para Aconchego',
                    text: 'Para criar uma atmosfera acolhedora, una notas gourmand doces e especiarias quentes. Evocam mem√≥rias felizes e a sensa√ß√£o de lar.',
                    examples: ['`Vanilla New` + `Ma√ß√£ com Canela` (conforto)', '`Cereja e Avel√£` + `Caf√© Torrado` (sofistica√ß√£o)']
                },
                sofisticacao: {
                    title: 'Combina√ß√µes para Sofistica√ß√£o',
                    text: 'Para um aroma luxuoso e marcante, combine florais complexos com notas orientais e ambaradas. Ideal para boutiques, hot√©is e eventos especiais.',
                    examples: ['`Jasmim e Rom√£` + `√Çmbar e Bergamota` (eleg√¢ncia)', '`Ange ou Demon` (mist√©rio)']
                }
            };
            
            const filtersContainer = document.getElementById('filters');
            const essenceGrid = document.getElementById('essence-grid');
            const emotionFiltersContainer = document.getElementById('emotion-filters');
            const suggestionBox = document.getElementById('suggestion-box');
            const suggestionText = document.getElementById('suggestion-text');
            const generateStoryBtn = document.getElementById('generate-story-btn');
            const storyOutput = document.getElementById('story-output');

            function renderFilters() {
                families.forEach(family => {
                    const btn = document.createElement('button');
                    btn.textContent = family;
                    btn.className = 'filter-btn px-4 py-2 rounded-full text-sm font-medium bg-white text-stone-700';
                    if (family === 'Todas') {
                        btn.classList.add('active');
                    }
                    btn.addEventListener('click', () => {
                        document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                        btn.classList.add('active');
                        renderEssences(family);
                    });
                    filtersContainer.appendChild(btn);
                });
            }

            function renderEssences(activeFamily = 'Todas') {
                essenceGrid.innerHTML = '';
                const filteredEssences = activeFamily === 'Todas' ? essences : essences.filter(e => e.family === activeFamily);
                
                filteredEssences.forEach(essence => {
                    const card = document.createElement('div');
                    card.className = 'essence-card bg-white p-4 rounded-lg shadow-sm border border-gray-100 flex flex-col justify-center items-center text-center';
                    card.draggable = true;
                    card.dataset.name = essence.name;
                    card.dataset.family = essence.family;
                    card.dataset.note = essence.note;

                    card.innerHTML = `<h3 class="font-semibold">${essence.name}</h3><p class="text-xs text-gray-500">${essence.family}</p>`;

                    card.addEventListener('dragstart', handleDragStart);
                    essenceGrid.appendChild(card);
                });
            }

            function renderEmotionFilters() {
                Object.keys(suggestions).forEach(key => {
                    const btn = document.createElement('button');
                    btn.textContent = key.charAt(0).toUpperCase() + key.slice(1);
                    btn.className = 'emotion-btn w-full bg-white text-stone-700 font-medium py-3 px-4 rounded-lg border border-stone-200 shadow-sm';
                    btn.dataset.emotion = key;
                    btn.addEventListener('click', handleEmotionClick);
                    emotionFiltersContainer.appendChild(btn);
                });
            }
            
            function handleEmotionClick(e) {
                const emotion = e.target.dataset.emotion;
                document.querySelectorAll('.emotion-btn').forEach(b => b.classList.remove('active'));
                e.target.classList.add('active');

                const suggestion = suggestions[emotion];
                suggestionBox.innerHTML = `
                    <h4 class="text-xl font-semibold mb-2 text-[#402E32]">${suggestion.title}</h4>
                    <p class="text-gray-600 mb-4">${suggestion.text}</p>
                    <div class="space-y-1">
                        ${suggestion.examples.map(ex => `<p class="text-sm text-stone-700 bg-stone-200/50 rounded px-2 py-1">${ex}</p>`).join('')}
                    </div>
                `;
            }

            function handleDragStart(e) {
                e.dataTransfer.setData('text/plain', JSON.stringify({
                    name: e.target.dataset.name,
                    note: e.target.dataset.note
                }));
            }

            const dropzones = document.querySelectorAll('.pyramid-dropzone');
            dropzones.forEach(zone => {
                zone.addEventListener('dragover', handleDragOver);
                zone.addEventListener('dragleave', handleDragLeave);
                zone.addEventListener('drop', handleDrop);
            });
            
            function handleDragOver(e) {
                e.preventDefault();
                e.currentTarget.classList.add('drag-over');
            }

            function handleDragLeave(e) {
                e.currentTarget.classList.remove('drag-over');
            }
            
            function handleDrop(e) {
                e.preventDefault();
                e.currentTarget.classList.remove('drag-over');
                const data = JSON.parse(e.dataTransfer.getData('text/plain'));
                const targetZoneType = e.currentTarget.dataset.noteType;
                
                if (e.currentTarget.querySelector('.text-gray-400')) {
                    e.currentTarget.innerHTML = '';
                }

                if (data.note === targetZoneType) {
                    addPill(e.currentTarget, data.name, 'success');
                } else {
                    addPill(e.currentTarget, data.name, 'error');
                }
                checkPyramidCompletion();
            }

            function addPill(container, name, type) {
                const pill = document.createElement('span');
                const baseClasses = 'text-sm font-medium px-2.5 py-1 rounded-full';
                if (type === 'success') {
                    pill.className = `bg-green-100 text-green-800 ${baseClasses}`;
                    pill.textContent = name;
                    container.appendChild(pill);
                } else if (type === 'error') {
                    pill.className = `bg-red-100 text-red-800 ${baseClasses}`;
                    pill.textContent = name;
                    container.appendChild(pill);
                    setTimeout(() => pill.remove(), 2000);
                }
            }
            
            function checkPyramidCompletion() {
                const topNotes = document.querySelectorAll('#dropzone-top span:not(.text-gray-400)');
                const middleNotes = document.querySelectorAll('#dropzone-middle span:not(.text-gray-400)');
                const baseNotes = document.querySelectorAll('#dropzone-base span:not(.text-gray-400)');

                if (topNotes.length > 0 && middleNotes.length > 0 && baseNotes.length > 0) {
                    generateStoryBtn.classList.remove('hidden');
                } else {
                    generateStoryBtn.classList.add('hidden');
                }
            }
            
            function resetPyramid() {
                document.getElementById('dropzone-top').innerHTML = '<span class="text-gray-400">Primeira Impress√£o</span>';
                document.getElementById('dropzone-middle').innerHTML = '<span class="text-gray-400">O Cora√ß√£o</span>';
                document.getElementById('dropzone-base').innerHTML = '<span class="text-gray-400">A Mem√≥ria</span>';
                generateStoryBtn.classList.add('hidden');
                storyOutput.classList.add('hidden');
                storyOutput.innerHTML = '';
                document.getElementById('bottle-output').classList.add('hidden');
                document.getElementById('bottle-output').innerHTML = '';
            }

            document.getElementById('reset-pyramid').addEventListener('click', resetPyramid);

            async function generateFragranceStory() {
                storyOutput.classList.remove('hidden');
                storyOutput.innerHTML = '<div class="loader"></div>';
                
                const getNotes = (id) => Array.from(document.querySelectorAll(`#${id} span:not(.text-gray-400)`)).map(span => span.textContent);
                
                const topNotes = getNotes('dropzone-top').join(', ');
                const middleNotes = getNotes('dropzone-middle').join(', ');
                const baseNotes = getNotes('dropzone-base').join(', ');

                const systemPrompt = "Voc√™ √© um perfumista de classe mundial e especialista em branding. Sua tarefa √© criar um nome e uma hist√≥ria de marketing para uma nova fragr√¢ncia com base nas notas fornecidas. Responda em portugu√™s do Brasil.";
                const userQuery = `Crie um nome e uma hist√≥ria para uma fragr√¢ncia com as seguintes notas:\nNotas de Sa√≠da: ${topNotes}\nNotas de Corpo: ${middleNotes}\nNotas de Fundo: ${baseNotes}`;

                const apiKey = ""; // API key will be injected by the environment
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

                const payload = {
                    contents: [{ parts: [{ text: userQuery }] }],
                    systemInstruction: { parts: [{ text: systemPrompt }] },
                    generationConfig: {
                        responseMimeType: "application/json",
                        responseSchema: {
                            type: "OBJECT",
                            properties: {
                                name: { type: "STRING", description: "O nome da fragr√¢ncia." },
                                story: { type: "STRING", description: "A hist√≥ria ou descri√ß√£o de marketing da fragr√¢ncia." }
                            },
                            required: ["name", "story"]
                        }
                    }
                };

                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        throw new Error(`API error: ${response.statusText}`);
                    }

                    const result = await response.json();
                    const text = result.candidates?.[0]?.content?.parts?.[0]?.text;
                    
                    if (text) {
                        const { name, story } = JSON.parse(text);
                        storyOutput.innerHTML = `
                            <div class="text-center p-6 bg-stone-50 rounded-lg">
                                <h3 class="text-2xl font-bold mb-2 text-[#402E32]">${name}</h3>
                                <p class="text-gray-600">${story}</p>
                                <button id="generate-bottle-btn" class="mt-6 w-full max-w-xs mx-auto gemini-btn font-semibold py-2 rounded-lg transition-colors">üïäÔ∏è Batizar com um Frasco</button>
                            </div>
                        `;
                        document.getElementById('generate-bottle-btn').addEventListener('click', () => baptizeFragrance(name, story));
                    } else {
                        throw new Error("Resposta da API inv√°lida.");
                    }
                } catch (error) {
                    console.error("Erro ao gerar hist√≥ria:", error);
                    storyOutput.innerHTML = `<p class="text-center text-red-500">Desculpe, n√£o foi poss√≠vel gerar a hist√≥ria. Tente novamente.</p>`;
                }
            }
            
            generateStoryBtn.addEventListener('click', generateFragranceStory);

            async function baptizeFragrance(name, story) {
                const bottleOutput = document.getElementById('bottle-output');
                bottleOutput.classList.remove('hidden');
                bottleOutput.innerHTML = '<div class="loader"></div>';

                const generateBottleBtn = document.getElementById('generate-bottle-btn');
                generateBottleBtn.disabled = true;
                generateBottleBtn.textContent = 'Batizando...';

                const getNotes = (id) => Array.from(document.querySelectorAll(`#${id} span:not(.text-gray-400)`)).map(span => span.textContent);
                const topNotes = getNotes('dropzone-top').join(', ');
                const middleNotes = getNotes('dropzone-middle').join(', ');
                const baseNotes = getNotes('dropzone-base').join(', ');

                const prompt = `Fotografia de produto de um frasco de perfume de luxo chamado "${name}". O design do frasco deve ser inspirado por esta hist√≥ria: "${story}". O frasco deve evocar a ess√™ncia de suas notas principais (${topNotes}, ${middleNotes}, ${baseNotes}). O estilo deve ser elegante e fotorealista, em um fundo de est√∫dio neutro com ilumina√ß√£o suave.`;

                const apiKey = ""; // API key will be injected
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/imagen-3.0-generate-002:predict?key=${apiKey}`;
                
                const payload = {
                    instances: [{ prompt: prompt }],
                    parameters: { "sampleCount": 1 }
                };

                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        throw new Error(`API error: ${response.statusText}`);
                    }

                    const result = await response.json();
                    const base64Data = result.predictions?.[0]?.bytesBase64Encoded;

                    if (base64Data) {
                        const imageUrl = `data:image/png;base64,${base64Data}`;
                        bottleOutput.innerHTML = `
                            <div class="text-center">
                                 <h3 class="text-2xl font-semibold mb-4">O Batismo da Fragr√¢ncia</h3>
                                 <img src="${imageUrl}" alt="Frasco de perfume para ${name}" class="rounded-lg shadow-lg mx-auto max-w-sm w-full">
                            </div>
                        `;
                    } else {
                         throw new Error("Nenhuma imagem recebida da API.");
                    }
                } catch (error) {
                    console.error("Erro ao batizar fragr√¢ncia:", error);
                    bottleOutput.innerHTML = `<p class="text-center text-red-500">Desculpe, n√£o foi poss√≠vel realizar o batismo. Tente novamente.</p>`;
                } finally {
                    generateBottleBtn.disabled = false;
                    generateBottleBtn.textContent = 'üïäÔ∏è Batizar com um Frasco';
                }
            }

            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    document.querySelector(this.getAttribute('href')).scrollIntoView({
                        behavior: 'smooth'
                    });
                });
            });

            renderFilters();
            renderEssences();
            renderEmotionFilters();
        });
    </script>
</body>
</html>







